/* EE2450 Fall 2018
 * 3D-Printer Project
 * Braulio Torres, Rocio Espinal, Wyatt Luong
 * Dr. Yi Zhao
 * dark.sight97@gmail.com
 *espinalrocio088@gmail.com
 */
#include <stdio.h>
#include <math.h>
#include <stdbool.h>

enum ShapeCode {
    SC_CUBE = 0,
    SC_CUBOID = 1,
    SC_SPHERE = 2,
    SC_CYLINDER = 3,
    SC_CONE = 4,
    SC_COUNT = 5
};
enum ColorCode {
    CC_RED = 0,
    CC_GREEN = 1,
    CC_BLUE = 2,
    CC_BLACK = 3,
    CC_COUNT = 4
};
enum CommandOption {
    CO_HELP = 0,
    CO_PRINT = 1,
    CO_STAT = 2,
    CO_INVEN = 3,
    CO_EXIT = 4
};



typedef struct ObjectData_struct {
    int index;
    bool valid;
    bool printed;
    int shape;
    int color;
    double volume;
} ObjectData;

// defines
#define MAX_OBJECTS 1000
#define PI 3.1415926
// global data
ObjectData g_objectList[MAX_OBJECTS];
int g_objectCount = 0;
double redRaw = 1000, greenRaw = 1000, blueRaw = 1000, blackRaw = 1000;
// function prototypes

void ProcessCommand(int command);

void DisplayOption(void);

void PrintObject(void);

ObjectData ReadObjectData(void);

void DisplayStatistics(void);

void ControlInventory();

void DisplayOption() {
    
    printf("\nCommand options:\n");
    printf(" 0- display help information\n");
    printf(" 1- print 3-D object\n");
    printf(" 2- object statistics\n");
    printf(" 3- materail inventory\n");
    printf(" 4- exit\n");
    
}

void DisplayHelp() {
    
    printf("\nCommand options:\n");
    printf(" 0- display help information - Displays Menu and Shape and Color Number Meaning.\n");
    printf("\n");
    printf(" 1- print 3-D object - User Input for desired shape, color and dimension.\n");
    printf("\n");
    printf(" 2- object statistics - User input statistics (percentage on shapes and colors printed, most popular color and shape, etc.)\n");
    printf("\n");
    printf(" 3- materail inventory - (track, display & restock raw materials.)\n");
    printf("\n");
    printf(" 4- exit\n");
    printf("\n");
    
    printf("*Legend*\n");
    printf("   0- Cube \t     0- Red \n");
    printf("   1- Cuboid \t 1- Green\n");
    printf("   2- Sphere \t 2-Blue\n");
    printf("   3- Cylinder \t 3-Black\n");
    printf("   4- Sphere\n");
    
    
}

void ProcessCommand(int command){
    switch(command){
        case CO_HELP:
            DisplayHelp();
            break;
        case CO_PRINT:
            PrintObject();
            break;
        case CO_STAT:
            DisplayStatistics();
            break;
        case CO_INVEN:
            ControlInventory();
            break;
        case CO_EXIT:
            printf("Exit program ...\n");
            break;
        default:
        printf("Invalid command!\n");}
    
}

void PrintObject() {
    
    ObjectData current;
    // step 1 - read 3-D object data from user
    current = ReadObjectData();
    g_objectList[g_objectCount] = current;
    g_objectCount++;
    // step 2 - print 3-D object & update materail inventory
}

ObjectData ReadObjectData()
{
    ObjectData object, restock;
    object.index = g_objectCount;
    object.valid = true;
    object.printed = false;
    int i, color, shape;
    double length;
    double height;
    double width;
    double radius;
    // read shape and color
    
    printf("Please enter the shape and color of object :\n");
    printf("Shape (0-4): ");
    scanf("%d", &shape);
    for(i = 0; i >= 0; i++){
        if (0 > shape || shape > 4){
            printf("Choose a shape in range: ");
            scanf("%d", &shape);
        }
        else
            break;
    }
    object.shape = shape;
    printf("Color(0-3): ");
    scanf("%d", &color);
    for(i = 0; i >= 0; i++){
        if (0 > color || color > 3){
            printf("Choose a shape in range: ");
            scanf("%d", &color);
        }
        else
            break;
    }
    object.color = color;
    
    // read object dimension
    switch (object.shape)
    {
        case SC_CUBE:
            printf("Please enter cube's side length : ");
            scanf("%lf", &length);
            object.volume = length * length * length;
                for(i = 0; i >= 0; i++){
                    if(object.volume > 1000) {
                        printf("Not enough material! Enter another cube's side length : ");
                        scanf("%lf", &length);
                        object.volume = length * length * length;
                    }
                    else
                        break;
                }
                
            printf("Cube Volume : %lf", object.volume);
            printf("\n");
            if(object.color == CC_RED) {
                redRaw = redRaw - object.volume;
                    if(redRaw < 0){
                        printf("No more material! Go to ""Material Inventory"" to restock.\n");
                        return restock;
                            break;
                        }
                    }
        
            else if(object.color == CC_GREEN) {
                greenRaw = greenRaw - object.volume;
            }
            else if(object.color == CC_BLUE) {
                blueRaw = blueRaw - object.volume;
            }
            if(object.color == CC_BLACK) {
                blackRaw = blackRaw - object.volume;
            }
            break;
        case SC_CUBOID:
            printf("Please enter cuboid's length, height & width : ");
            scanf("%lf%lf%lf", &length, &width, &height);
            object.volume = length * width * height;
            printf("Cuboid Volume : %lf", object.volume);
            printf("\n");
            
            if(object.color == CC_RED) {
                redRaw = redRaw - object.volume;
                if(redRaw < 0){
                    int option;
                    while(g_objectCount>0){
                        printf("You have to restock : ");
                        scanf("%d", &option);
                        if(option == 1){
                            redRaw = 1000;
                            break;
                        }
                        else {
                            continue;
                        }
                    }
                }
            }
   
            else if(object.color == CC_GREEN) {
                greenRaw = greenRaw - object.volume;
            }
            else if(object.color == CC_BLUE) {
                blueRaw = blueRaw - object.volume;
            }
            if(object.color == CC_BLACK) {
                blackRaw = blackRaw - object.volume;
            }
            break;
        case SC_SPHERE:
            printf("Please enter sphere's radius : ");
            scanf("%lf", &radius);
            object.volume = (4.0/3.0) * PI * (radius * radius * radius);
            printf("Sphere Volume : %lf", object.volume);
            printf("\n");
            if(object.color == CC_RED) {
                redRaw = redRaw - object.volume;
            }
            else if(object.color == CC_GREEN) {
                greenRaw = greenRaw - object.volume;
            }
            else if(object.color == CC_BLUE) {
                blueRaw = blueRaw - object.volume;
            }
            if(object.color == CC_BLACK) {
                blackRaw = blackRaw - object.volume;
            }
            break;
        case SC_CYLINDER:
            printf("Please enter cylinder's radius and height : \n");
            printf("Radius : ");
            scanf("%lf", &radius);
            printf("Height : ");
            scanf("%lf", &height);
            object.volume = PI * (radius * radius) * height;
            printf("Cylinder Volume : %lf", object.volume);
            printf("\n");
            if(object.color == CC_RED) {
                redRaw = redRaw - object.volume;
            }
            else if(object.color == CC_GREEN) {
                greenRaw = greenRaw - object.volume;
            }
            else if(object.color == CC_BLUE) {
                blueRaw = blueRaw - object.volume;
            }
            if(object.color == CC_BLACK) {
                blackRaw = blackRaw - object.volume;
            }
            break;
        case SC_CONE:
            printf("Please enter cone's radius and height : \n");
            printf("Radius : ");
            scanf("%lf", &radius);
            printf("Height : ");
            scanf("%lf", &height);
            object.volume = (height/3.0) * PI * (radius * radius);
            printf("Cone Volume : %lf", object.volume);
            printf("\n");
            if(object.color == CC_RED) {
                redRaw = redRaw - object.volume;
            }
            else if(object.color == CC_GREEN) {
                greenRaw = greenRaw - object.volume;
            }
            else if(object.color == CC_BLUE) {
                blueRaw = blueRaw - object.volume;
            }
            if(object.color == CC_BLACK) {
                blackRaw = blackRaw - object.volume;
            }
            break;
    }
    // compute object volume
    return object;
}


void DisplayStatistics()
{
    // display object statistics
}

void ControlInventory() {
    ObjectData update = g_objectList [g_objectCount-1];
    
    printf("What would you like to do?\n");
    printf("/t 1) Restock\n 2) See Raw  ")
    
    if(redRaw < 0){
        printf("You have to restock : ");
}
    /*for(int i=0; i< g_objectCount; i++){
        if(g_objectList [i].color == 0) {
            redRaw = redRaw - g_objectList [i].volume;
            if(redRaw < 0) {
                int option;
                while(g_objectCount>0){
                    printf("You have to restock : ");
                    scanf("%d", &option);
                    if(option == 1){
                        redRaw = 1000;
                        break;
                    }
                    else {
                        continue;
                    }
                }
            }
        }
        else if(g_objectList [i].color == 1) {
            greenRaw = greenRaw - g_objectList [i].volume;
            if(greenRaw < g_objectList [i].volume) {
                int option;
                while(g_objectCount>0){
                    printf("You have to restock : ");
                    scanf("%d", &option);
                    if(option == 1){
                        greenRaw = 1000;
                        break;
                    }
                    else {
                        continue;
                    }
                }
            }
        }
        else if(g_objectList [i].color == 2) {
            blueRaw = blueRaw - g_objectList [i].volume;
            if(blueRaw < g_objectList [i].volume) {
                int option;
                while(g_objectCount>0){
                    printf("You have to restock : ");
                    scanf("%d", &option);
                    if(option == 1){
                        blueRaw = 1000;
                        break;
                    }
                    else {
                        continue;
                    }
                }
            }
        }
        else if(g_objectList [i].color == 3) {
            blackRaw = blackRaw - g_objectList [i].volume;
            if(blackRaw < g_objectList [i].volume) {
                int option;
                while(g_objectCount>0){
                    printf("You have to restock : ");
                    scanf("%d", &option);
                    if(option == 1){
                        blackRaw = 1000;
                        break;
                    }
                    else {
                        continue;
                    }
                }
            }
        }
        
    }*/
    
    printf("Current %d volume :%f\n", update.shape, update.volume);
    printf("%f\n", redRaw);
    printf("%f\n", greenRaw);
    printf("%f\n", blueRaw);
    printf("%f\n", blackRaw);
    
}


int main() {
    int command = CO_HELP;
    printf("Welcome to 3-D Printer!");
    
    DisplayOption();
    
    do {
        printf("\nPlease enter command : ");
        scanf("%d", &command);
        printf("\n");
        ProcessCommand(command);
    }
    while (command != CO_EXIT);
    return 0;
}



